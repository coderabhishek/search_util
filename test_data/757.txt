Theorem 31.20
For any positive integers a and n, if d = gcd(a, n), then
(31.22)
in Zn, and thus
| a | = n/d.
Proof We begin by showing that d
a . Recall that EXTENDED-EUCLID(a, n) produces
integers x′ and y′ such that ax′ + ny′ = d. Thus, ax′ ≡ d (mod n), so that d
a .
Since d
a , it follows that every multiple of d belongs to a , because any multiple of a
multiple of a is itself a multiple of a. Thus, a contains every element in {0, d, 2d, ..., ((n/d)
- 1)d}. That is, d
a .
We now show that a
d . If m
a , then m = ax mod n for some integer x, and so
m = ax + ny for some integer y. However, d | a and d | n, and so d | m by equation (31.4).
Therefore, m
d .
Combining these results, we have that a = d . To see that | a | = n/d, observe that
there are exactly n/d multiples of d between 0 and n - 1, inclusive.

Corollary 31.21
The equation ax ≡ b (mod n) is solvable for the unknown x if and only if gcd(a, n) | b.

Corollary 31.22
The equation ax ≡ b (mod n) either has d distinct solutions modulo n, where d = gcd(a, n), or
it has no solutions.
Proof If ax ≡ b (mod n) has a solution, then b
a . By Theorem 31.17, ord(a) = | a |,
and so Corollary 31.18 and Theorem 31.20 imply that the sequence ai mod n, for i = 0, 1, ...,
is periodic with period | a | = n/d. If b
a , then b appears exactly d times in the
sequence ai mod n, for i = 0, 1, ..., n - 1, since the length-(n/d) block of values a is
repeated exactly d times as i increases from 0 to n - 1. The indices x of the d positions for
which ax mod n = b are the solutions of the equation ax ≡ b (mod n).

Theorem 31.23

