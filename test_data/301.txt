the two input sequences. To be precise, given a sequence X = x1, x2, ..., xm , we define the
ith prefix of X, for i = 0, 1, ..., m, as Xi = x1, x2, ..., xi . For example, if X = A, B, C, B, D,
A, B , then X4 = A, B, C, B and X0 is the empty sequence.
Theorem 15.1: (Optimal substructure of an LCS)
Let X = x1, x2, ..., xm
any LCS of X and Y.

and Y =

y1, y2, ..., yn

be sequences, and let Z =

z1, z2, ..., zk

be

1. If xm = yn, then zk = xm = yn and Zk-1 is an LCS of Xm-1 and Yn-1.
2. If xm ≠ yn, then zk ≠ xm implies that Z is an LCS of Xm-1 and Y.
3. If xm ≠ yn, then zk ≠ yn implies that Z is an LCS of X and Yn-1.
Proof (1) If zk ≠ xm, then we could append xm = yn to Z to obtain a common subsequence of X
and Y of length k + 1, contradicting the supposition that Z is a longest common subsequence
of X and Y . Thus, we must have zk = xm = yn. Now, the prefix Zk-1 is a length-(k - 1) common
subsequence of Xm-1 and Yn-1. We wish to show that it is an LCS. Suppose for the purpose of
contradiction that there is a common subsequence W of Xm-1 and Yn-1 with length greater than
k - 1. Then, appending xm = yn to W produces a common subsequence of X and Y whose length
is greater than k, which is a contradiction.
(2) If zk ≠ xm, then Z is a common subsequence of Xm-1 and Y. If there were a common
subsequence W of Xm-1 and Y with length greater than k, then W would also be a common
subsequence of Xm and Y , contradicting the assumption that Z is an LCS of X and Y.
(3) The proof is symmetric to (2).

The characterization of Theorem 15.1 shows that an LCS of two sequences contains within it
an LCS of prefixes of the two sequences. Thus, the LCS problem has an optimal-substructure
property. A recursive solution also has the overlapping-subproblems property, as we shall see
in a moment.
Step 2: A recursive solution
Theorem 15.1 implies that there are either one or two subproblems to examine when finding
an LCS of X = x1, x2, ..., xm and Y = y1, y2, ..., yn . If xm = yn, we must find an LCS of
Xm-1 and Yn-1. Appending xm = yn to this LCS yields an LCS of X and Y. If xm ≠ yn, then we
must solve two subproblems: finding an LCS of Xm-1 and Y and finding an LCS of X and Yn-1.
Whichever of these two LCS's is longer is an LCS of X and Y. Because these cases exhaust all
possibilities, we know that one of the optimal subproblem solutions must be used within an
LCS of X and Y .
We can readily see the overlapping-subproblems property in the LCS problem. To find an
LCS of X and Y , we may need to find the LCS's of X and Yn-1 and of Xm-1 and Y . But each of
these subproblems has the subsubproblem of finding the LCS of Xm-1 and Yn-1. Many other
subproblems share subsubproblems.

