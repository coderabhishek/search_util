For any odd integer n > 2 and positive integer s, the probability that MILLER-RABIN(n, s)
errs is at most 2-s.
Proof Using Theorem 31.38, we see that if n is composite, then each execution of the for loop
of lines 1–4 has a probability of at least 1/2 of discovering a witness x to the compositeness of
n. MILLER-RABIN makes an error only if it is so unlucky as to miss discovering a witness to
the compositeness of n on each of the s iterations of the main loop. The probability of such a
string of misses is at most 2-s.

Thus, choosing s = 50 should suffice for almost any imaginable application. If we are trying
to find large primes by applying MILLER-RABIN to randomly chosen large integers, then it
can be argued (although we won't do so here) that choosing a small value of s (say 3) is very
unlikely to lead to erroneous results. That is, for a randomly chosen odd composite integer n,
the expected number of nonwitnesses to the compositeness of n is likely to be much smaller
than (n - 1)/2. If the integer n is not chosen randomly, however, the best that can be proven is
that the number of nonwitnesses is at most (n - 1)/4, using an improved version of Theorem
31.39. Furthermore, there do exist integers n for which the number of nonwitnesses is (n 1)/4.
Exercises 31.8-1
Prove that if an odd integer n > 1 is not a prime or a prime power, then there exists a
nontrivial square root of 1 modulo n.

Exercises 31.8-2:
It is possible to strengthen Euler's theorem slightly to the form
aλ(n) ≡ 1 (mod n) for all
where

,

and λ(n) is defined by

(31.40)
Prove that λ(n) | φ(n). A composite number n is a Carmichael number if λ(n) | n - 1. The
smallest Carmichael number is 561 = 3 · 11 · 17; here, λ(n) = lcm(2, 10, 16) = 80, which
divides 560. Prove that Carmichael numbers must be both "square-free" (not divisible by the
square of any prime) and the product of at least three primes. For this reason, they are not
very common.

Exercises 31.8-3

