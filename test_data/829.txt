Figure 33.7: The execution of GRAHAM-SCAN on the set Q of Figure 33.6. The current
convex hull contained in stack S is shown in gray at each step. (a) The sequence p1, p2, ...,
p12 of points numbered in order of increasing polar angle relative to p0, and the initial stack
S containing p0, p1, and p2. (b)-(k) Stack S after each iteration of the for loop of lines 6-9.
Dashed lines show nonleft turns, which cause points to be popped from the stack. In part (h),
for example, the right turn at angle p7p8p9 causes p8 to be popped, and then the right turn at
angle p6p7p9 causes p7 to be popped. (l) The convex hull returned by the procedure, which
matches that of Figure 33.6.
The remainder of the procedure uses the stack S. Lines 3-5 initialize the stack to contain, from
bottom to top, the first three points p0, p1, and p2. Figure 33.7(a) shows the initial stack S. The
for loop of lines 6-9 iterates once for each point in the subsequence p3, p4, ..., pm . The
intent is that after processing point pi , stack S contains, from bottom to top, the vertices of
CH({ p0, p1, ..., pi}) in counterclockwise order. The while loop of lines 7-8 removes points
from the stack if they are found not to be vertices of the convex hull. When we traverse the
convex hull counterclockwise, we should make a left turn at each vertex. Thus, each time the
while loop finds a vertex at which we make a nonleft turn, the vertex is popped from the
stack. (By checking for a nonleft turn, rather than just a right turn, this test precludes the
possibility of a straight angle at a vertex of the resulting convex hull. We want no straight
angles, since no vertex of a convex polygon may be a convex combination of other vertices of
the polygon.) After we pop all vertices that have nonleft turns when heading toward point pi ,
we push pi onto the stack. Figures 33.7(b)-(k) show the state of the stack S after each iteration
of the for loop. Finally, GRAHAM-SCAN returns the stack S in line 10. Figure 33.7(l) shows
the corresponding convex hull.
The following theorem formally proves the correctness of GRAHAM-SCAN.
Theorem 33.1: (Correctness of Graham's scan)
If GRAHAM-SCAN is run on a set Q of points, where |Q| ≥ 3, then at termination, the stack S
consists of, from bottom to top, exactly the vertices of CH(Q) in counterclockwise order.
Proof After line 2, we have the sequence of points p1, p2, ..., pm . Let us define, for i = 2, 3,
..., m, the subset of points Qi = {p0, p1, ..., pi}. The points in Q - Qm are those that were
removed because they had the same polar angle relative to p0 as some point in Qm; these
points are not in CH(Q), and so CH(Qm) = CH(Q). Thus, it suffices to show that when
GRAHAM-SCAN terminates, the stack S consists of the vertices of CH(Qm) in
counterclockwise order from bottom to top. Note that just as p0, p1, and pm are vertices of
CH(Q), the points p0, p1, and pi are all vertices of CH(Qi).
The proof uses the following loop invariant:
•
•

At the start of each iteration of the for loop of lines 6-9, stack S consists of, from
bottom to top, exactly the vertices of CH(Qi-1) in counterclockwise order.
Initialization: The invariant holds the first time we execute line 6, since at that time,
stack S consists of exactly the vertices of Q2 = Qi-1, and this set of three vertices forms
its own convex hull. Moreover, they appear in counterclockwise order from bottom to
top.

