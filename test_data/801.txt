Figure 32.7: (a) A state-transition diagram for the string-matching automaton that accepts all
strings ending in the string ababaca. State 0 is the start state, and state 7 (shown blackened) is
the only accepting state. A directed edge from state i to state j labeled a represents δ(i, a) = j.
The right-going edges forming the "spine" of the automaton, shown heavy in the figure,
correspond to successful matches between pattern and input characters. The left-going edges
correspond to failing matches. Some edges corresponding to failing matches are not shown;
by convention, if a state i has no outgoing edge labeled a for some a Σ, then δ(i, a) = 0. (b)
The corresponding transition function δ, and the pattern string P = ababaca. The entries
corresponding to successful matches between pattern and input characters are shown shaded.
(c) The operation of the automaton on the text T = abababacaba. Under each text character T
[i] is given the state φ(Ti) the automaton is in after processing the prefix Ti. One occurrence of
the pattern is found, ending in position 9.
In order to specify the string-matching automaton corresponding to a given pattern P[1 m],
we first define an auxiliary function σ , called the suffix function corresponding to P. The
function σ is a mapping from Σ* to {0, 1, . . . , m} such that σ(x) is the length of the longest
prefix of P that is a suffix of x:
σ(x) = max {k : Pk ⊐ x}.
The suffix function σ is well defined since the empty string P0 = ε is a suffix of every string.
As examples, for the pattern P = ab, we have σ(ε) = 0, σ(ccaca) = 1, and σ(ccab) = 2. For a
pattern P of length m, we have σ(x) = m if and only if P ⊐ x. It follows from the definition of
the suffix function that if x ⊐ y, then σ(x) ≤ σ(y).
We define the string-matching automaton that corresponds to a given pattern P[1
follows.
•
•

m] as

The state set Q is {0, 1, . . . , m}. The start state q0 is state 0, and state m is the only
accepting state.
The transition function δ is defined by the following equation, for any state q and
character a:
(32.3)

