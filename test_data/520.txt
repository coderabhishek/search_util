Thus, the sum of weights around the cycle c is negative, which provides the desired
contradiction.
We have now proven that Gπ is a directed, acyclic graph. To show that it forms a rooted tree
with root s, it suffices (see Exercise B.5-2) to prove that for each vertex v Vπ, there is a
unique path from s to v in Gπ.
We first must show that a path from s exists for each vertex in Vπ. The vertices in Vπ are those
with non-NIL π values, plus s. The idea here is to prove by induction that a path exists from s
to all vertices in Vπ. The details are left as Exercise 24.5-6.
To complete the proof of the lemma, we must now show that for any vertex v Vπ, there is at
most one path from s to v in the graph Gπ. Suppose otherwise. That is, suppose that there are
two simple paths from s to some vertex v: p1, which can be decomposed into
and p2, which can be decomposed into
, where x ≠ y. (See Figure 24.9.) But
then, π[z] = x and π[z] = y, which implies the contradiction that x = y. We conclude that there
exists a unique simple path in Gπ from s to v, and thus Gπ forms a rooted tree with root s.

Figure 24.9: Showing that a path in Gπ from source s to vertex v is unique. If there are two
paths
and
, where x ≠ y, then π[z] = x and π[z] = y, a
contradiction.

We can now show that if, after we have performed a sequence of relaxation steps, all vertices
have been assigned their true shortest-path weights, then the predecessor subgraph Gπ is a
shortest-paths tree.
Lemma 24.17: (Predecessor-subgraph property)
Let G = (V, E) be a weighted, directed graph with weight function w : E → R, let s V be a
source vertex, and assume that G contains no negative-weight cycles that are reachable from
s. Let us call INITIALIZE-SINGLE-SOURCE(G, s) and then execute any sequence of
relaxation steps on edges of G that produces d[v] = δ(s, v) for all v V. Then, the predecessor
subgraph Gπ is a shortest-paths tree rooted at s.
Proof We must prove that the three properties of shortest-paths trees given on page 584 hold
for Gπ . To show the first property, we must show that Vπ is the set of vertices reachable from
s. By definition, a shortest-path weight δ(s, v) is finite if and only if v is reachable from s, and
thus the vertices that are reachable from s are exactly those with finite d values. But a vertex v
V - {s} has been assigned a finite value for d[v] if and only if π[v] ≠ NIL. Thus, the vertices
in Vπ are exactly those reachable from s.

