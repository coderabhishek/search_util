In the traveling-salesman problem, which is closely related to the hamiltonian-cycle problem,
a salesman must visit n cities. Modeling the problem as a complete graph with n vertices, we
can say that the salesman wishes to make a tour, or hamiltonian cycle, visiting each city
exactly once and finishing at the city he starts from. There is an integer cost c(i, j) to travel
from city i to city j, and the salesman wishes to make the tour whose total cost is minimum,
where the total cost is the sum of the individual costs along the edges of the tour. For
example, in Figure 34.18, a minimum-cost tour is u, w, v, x, u , with cost 7. The formal
language for the corresponding decision problem is
TSP = { G, c, k : G = (V, E) is a complete graph, c is a function from V × V → Z, k
and G has a traveling-salesman tour with cost at most k}.

Z,

Figure 34.18: An instance of the traveling-salesman problem. Shaded edges represent a
minimum-cost tour, with cost 7.
The following theorem shows that a fast algorithm for the traveling-salesman problem is
unlikely to exist.
Theorem 34.14
The traveling-salesman problem is NP-complete.
Proof We first show that TSP belongs to NP. Given an instance of the problem, we use as a
certificate the sequence of n vertices in the tour. The verification algorithm checks that this
sequence contains each vertex exactly once, sums up the edge costs, and checks whether the
sum is at most k. This process can certainly be done in polynomial time.
To prove that TSP is NP-hard, we show that HAM-CYCLE ≤P TSP. Let G = (V, E) be an
instance of HAM-CYCLE. We construct an instance of TSP as follows. We form the
complete graph G' = (V, E'), where E' = {(i, j) : i, j V and i ≠ j}, and we define the cost
function c by

(Note that because G is undirected, it has no self-loops, and so c(v, v) = 1 for all vertices v
V.) The instance of TSP is then (G', c, 0), which is easily formed in polynomial time.
We now show that graph G has a hamiltonian cycle if and only if graph G' has a tour of cost
at most 0. Suppose that graph G has a hamiltonian cycle h. Each edge in h belongs to E and
thus has cost 0 in G'. Thus, h is a tour in G' with cost 0. Conversely, suppose that graph G' has

