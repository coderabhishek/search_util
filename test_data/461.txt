was discovered more recently than u, all of its outgoing edges are explored, and v is finished,
before the search returns to and finishes u. In this case, therefore, the interval [d[v], f[v]] is
entirely contained within the interval [d[u], f[u]]. In the other subcase, f[u] < d[v], and
inequality (22.2) implies that the intervals [d[u], f[u]] and [d[v], f[v]] are disjoint. Because the
intervals are disjoint, neither vertex was discovered while the other was gray, and so neither
vertex is a descendant of the other.
The case in which d[v] < d[u] is similar, with the roles of u and v reversed in the above
argument.

Corollary 22.8: (Nesting of Descendants' Intervals)
Vertex v is a proper descendant of vertex u in the depth-first forest for a (directed or
undirected) graph G if and only if d[u] < d[v] < f[v] < f[u].
Proof Immediate from Theorem 22.7.

The next theorem gives another important characterization of when one vertex is a descendant
of another in the depth-first forest.
Theorem 22.9: (White-path theorem)
In a depth-first forest of a (directed or undirected) graph G = (V, E), vertex v is a descendant
of vertex u if and only if at the time d[u] that the search discovers u, vertex v can be reached
from u along a path consisting entirely of white vertices.
Proof : Assume that v is a descendant of u. Let w be any vertex on the path between u and v
in the depth-first tree, so that w is a descendant of u. By Corollary 22.8, d[u] < d[w], and so w
is white at time d[u].
⇐: Suppose that vertex v is reachable from u along a path of white vertices at time d[u], but v
does not become a descendant of u in the depth-first tree. Without loss of generality, assume
that every other vertex along the path becomes a descendant of u. (Otherwise, let v be the
closest vertex to u along the path that doesn't become a descendant of u.) Let w be the
predecessor of v in the path, so that w is a descendant of u (w and u may in fact be the same
vertex) and, by Corollary 22.8, f[w] ≤ f[u]. Note that v must be discovered after u is
discovered, but before w is finished. Therefore, d[u] < d[v] < f[w] ≤ f[u]. Theorem 22.7 then
implies that the interval [d[v], f[v]] is contained entirely within the interval [d[u], f[u]]. By
Corollary 22.8, v must after all be a descendant of u.

