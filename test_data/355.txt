to define Φ (D0) to be 0 and then to show that Φ (Di) ≥ 0 for all i. (See Exercise 17.3-1 for an
easy way to handle cases in which Φ(D0) ≠ 0.)
Intuitively, if the potential difference Φ(Di) - Φ(Di-1) of the ith operation is positive, then the
amortized cost represents an overcharge to the ith operation, and the potential of the data
structure increases. If the potential difference is negative, then the amortized cost represents
an undercharge to the ith operation, and the actual cost of the operation is paid by the decrease
in the potential.
The amortized costs defined by equations (17.2) and (17.3) depend on the choice of the
potential function Φ. Different potential functions may yield different amortized costs yet still
be upper bounds on the actual costs. There are often trade-offs that can be made in choosing a
potential function; the best potential function to use depends on the desired time bounds.
Stack operations
To illustrate the potential method, we return once again to the example of the stack operations
PUSH, POP, and MULTIPOP. We define the potential function Φ on a stack to be the number
of objects in the stack. For the empty stack D0 with which we start, we have Φ(D0) = 0. Since
the number of objects in the stack is never negative, the stack Di that results after the ith
operation has nonnegative potential, and thus
Φ(Di) ≥ 0
= Φ(D0).
The total amortized cost of n operations with respect to Φ therefore represents an upper bound
on the actual cost.
Let us now compute the amortized costs of the various stack operations. If the ith operation on
a stack containing s objects is a PUSH operation, then the potential difference is
Φ(Di) - Φ(Di-1) = (s + 1) -s
=1
By equation (17.2), the amortized cost of this PUSH operation is
= ci + Φ(Di) - Φ (Di-1)
=1+1
=2
Suppose that the ith operation on the stack is MULTIPOP(S, k) and that ′ = min(k, s) objects
are popped off the stack. The actual cost of the operation is ′, and the potential difference is
Φ(Di) - Φ(Di-1) - -′.
Thus, the amortized cost of the MULTIPOP operation is
= ci + Φ(Di) - Φ(Di-1)

