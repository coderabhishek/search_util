weight of edge (vi , vj) is w(vi, vj) = bk. The weight of each edge leaving v0 is 0. Figure 24.8
shows the constraint graph for the system (24.3)-(24.10) of difference constraints.

Figure 24.8: The constraint graph corresponding to the system (24.3)-(24.10) of difference
constraints. The value of δ(v0, vi) is shown in each vertex vi. A feasible solution to the system
is x = (-5, -3, 0, -1, -4).
The following theorem shows that we can find a solution to a system of difference constraints
by finding shortest-path weights in the corresponding constraint graph.
Theorem 24.9
Given a system Ax ≤ b of difference constraints, let G = (V, E) be the corresponding constraint
graph. If G contains no negative-weight cycles, then
(24.11)
is a feasible solution for the system. If G contains a negative-weight cycle, then there is no
feasible solution for the system.
Proof We first show that if the constraint graph contains no negative-weight cycles, then
equation (24.11) gives a feasible solution. Consider any edge (vi, vj) E. By the triangle
inequality, δ(v0, vj) ≤ δ(v0, vi) + w(vi, vj) or, equivalently, δ(v0, vj) - δ(v0, vi) ≤ w(vi, vj). Thus,
letting xi = δ(v0, vi) and xj = δ(v0, vj) satisfies the difference constraint xj - xi ≤ w(vi, vj) that
corresponds to edge (vi, vj).
Now we show that if the constraint graph contains a negative-weight cycle, then the system of
difference constraints has no feasible solution. Without loss of generality, let the negativeweight cycle be c = v1, v2,..., vk , where v1 = vk. (The vertex v0 cannot be on cycle c,
because it has no entering edges.) Cycle c corresponds to the following difference constraints:
x2 - x1 ≤ w(v1, v2),
x3 - x2 ⋮ w(v2, v3),
≤
xk - xk-1 ≤ w(vk-1, vk),
x1 - xk ≤ w(vk, v1).

