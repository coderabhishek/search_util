edge (v, w) Ef, and therefore a simple path of the form
choice of w.

in Gf, contradicting our

Thus, we must have f(Ū, U) ≤ 0, since every term in this implicit summation is nonpositive,
and hence
e(U) = f(V, U)
(by equation (26.9))
= f(Ū, U) + f(U, U) (by Lemma 26.1, part (3))
= f(Ū, U)
(by Lemma 26.1, part (1))
≤ 0.
Excesses are nonnegative for all vertices in V -{s}; because we have assumed that U
we must therefore have e(v) = 0 for all vertices v U. In particular, e(u) = 0, which
contradicts the assumption that u is overflowing.

V -{s},

The next lemma bounds the heights of vertices, and its corollary bounds the number of relabel
operations that are performed in total.
Lemma 26.21
Let G = (V, E) be a flow network with source s and sink t. At any time during the execution of
GENERIC-PUSH-RELABEL on G, we have h[u] ≤ 2 |V| - 1 for all vertices u V.
Proof The heights of the source s and the sink t never change because these vertices are by
definition not overflowing. Thus, we always have h[s] = |V| and h[t] = 0, both of which are no
greater than 2 |V | - 1.
Now consider any vertex u V -{s, t}. Initially, h[u] = 0 ≤ 2 |V|-1. We shall show that after
each relabeling operation, we still have h[u] ≤ 2 |V|-1. When u is relabeled, it is overflowing,
and Lemma 26.20 tells us that there is a simple path p from u to s in Gf. Let p = v0, v1, . . .
,vk , where v0 = u, vk = s, and k ≤ |V|-1 because p is simple. For i = 0, 1, . . . , k - 1, we have
(vi, vi+1) Ef, and therefore, by Lemma 26.17, h[vi] ≤ h[vi+1] + 1. Expanding these inequalities
over path p yields h[u] = h[v0] ≤ h[vk] + k ≤ h[s] + (|V| - 1) = 2 |V| - 1.

Corollary 26.22: (Bound on relabel operations)
Let G = (V, E) be a flow network with source s and sink t. Then, during the execution of
GENERIC-PUSH-RELABEL on G, the number of relabel operations is at most 2 |V| - 1 per
vertex and at most (2 |V| - 1)|V| - 2) < 2 |V|2 overall.
Proof Only the |V|-2 vertices in V -{s, t} may be relabeled. Let u V -{s, t}. The operation
RELABEL(u) increases h[u]. The value of h[u] is initially 0 and by Lemma 26.21 grows to at

