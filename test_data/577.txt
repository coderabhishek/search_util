We are now ready to show that if the generic push-relabel algorithm terminates, the preflow it
computes is a maximum flow.
Theorem 26.19: (Correctness of the generic push-relabel algorithm)
If the algorithm GENERIC-PUSH-RELABEL terminates when run on a flow network G = (V,
E) with source s and sink t, then the preflow f it computes is a maximum flow for G.
Proof We use the following loop invariant:
•

Each time the while loop test in line 2 in GENERIC-PUSH-RELABEL is executed, f
is a preflow.

•
•

Initialization: INITIALIZE-PREFLOW makes f a preflow.
Maintenance: The only operations within the while loop of lines 2-3 are push and
relabel. Relabel operations affect only height attributes and not the flow values; hence
they do not affect whether f is a preflow. As argued on page 672, if f is a preflow prior
to a push operation, it remains a preflow afterward.
Termination: At termination, each vertex in V - {s, t} must have an excess of 0,
because by Lemmas 26.15 and 26.17 and the invariant that f is always a preflow, there
are no overflowing vertices. Therefore, f is a flow. Because h is a height function,
Lemma 26.18 tells us that there is no path from s to t in the residual network Gf. By
the max-flow min-cut theorem (Theorem 26.7), therefore, f is a maximum flow.

•

Analysis of the push-relabel method
To show that the generic push-relabel algorithm indeed terminates, we shall bound the
number of operations it performs. Each of the three types of operations-relabels, saturating
pushes, and nonsaturating pushes-is bounded separately. With knowledge of these bounds, it
is a straightforward problem to construct an algorithm that runs in O(V2E) time. Before
beginning the analysis, however, we prove an important lemma.
Lemma 26.20
Let G = (V, E) be a flow network with source s and sink t, and let f be a preflow in G. Then,
for any overflowing vertex u, there is a simple path from u to s in the residual network Gf.
Proof For an overflowing vertex u, let U = {v: there exists a simple path from u to v in Gf},
and suppose for the sake of contradiction that s ∉ U. Let Ū = V - U.
We claim for each pair of vertices w Ū and v U that f(w, v) ≤ 0. Why? If f(w, v) > 0, then
f(v, w) < 0, which in turn implies that cf(v, w) = c(v, w) - f(v, w) > 0. Hence, there exists an

