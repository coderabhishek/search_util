Figure 26.10: The action of RELABEL-TO-FRONT. (a) A flow network just before the first
iteration of the while loop. Initially, 26 units of flow leave source s. On the right is shown the
initial list L = x, y, z , where initially u = x. Under each vertex in list L is its neighbor list,
with the current neighbor shaded. Vertex x is discharged. It is relabeled to height 1, 5 units of
excess flow are pushed to y, and the 7 remaining units of excess are pushed to the sink t.
Because x is relabeled, it is moved to the head of L, which in this case does not change the
structure of L. (b) After x, the next vertex in L that is discharged is y. Figure 26.9 shows the
detailed action of discharging y in this situation. Because y is relabeled, it is moved to the
head of L. (c) Vertex x now follows y in L, and so it is again discharged, pushing all 5 units of
excess flow to t. Because vertex x is not relabeled in this discharge operation, it remains in
place in list L. (d) Since vertex z follows vertex x in L, it is discharged. It is relabeled to height
1 and all 8 units of excess flow are pushed to t. Because z is relabeled, it is moved to the front
of L. (e) Vertex y now follows vertex z in L and is therefore discharged. But because y has no
excess, DISCHARGE immediately returns, and y remains in place in L. Vertex x is then
discharged. Because it, too, has no excess, DISCHARGE again returns, and x remains in place
in L. RELABEL-TO-FRONT has reached the end of list L and terminates. There are no
overflowing vertices, and the preflow is a maximum flow.

