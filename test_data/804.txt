Proof The proof is by induction on i. For i = 0, the theorem is trivially true, since T0 = ε. Thus,
φ(T0) = 0 = σ(T0).
Now, we assume that φ(Ti) = σ(Ti) and prove that φ(Ti+1) = σ(Ti+1). Let q denote φ(Ti), and let
a denote T[i + 1]. Then,
φ(Ti+1) = φ(Tia)

(by the definitions of Ti+1 and
a)
= δ(φ(Ti), a) (by the definition of φ)
= δ(q, a)
(by the definition of q)
= σ(Pqa)
(by the definition (32.3) of δ)
= σ(Tia)
(by Lemma 32.3 and induction)
(by the definition of Ti+1).
= σ(Ti+1)

By Theorem 32.4, if the machine enters state q on line 4, then q is the largest value such that
Pq ⊐ Ti. Thus, we have q = m on line 5 if and only if an occurrence of the pattern P has just
been scanned. We conclude that FINITE-AUTOMATON-MATCHER operates correctly.
Computing the transition function
The following procedure computes the transition function δ from a given pattern P[1

m].

COMPUTE-TRANSITION-FUNCTION(P, Σ)
1 m ← length[P]
2 for q ← 0 to m
3
do for each character a
Σ
4
do k ← min(m + 1, q + 2)
5
repeat k ← k - 1
6
7
8 return δ

until Pk ⊐ Pqa
δ(q, a) ← k

This procedure computes δ(q, a) in a straightforward manner according to its definition. The
nested loops beginning on lines 2 and 3 consider all states q and characters a, and lines 4-7 set
δ(q, a) to be the largest k such that Pk ⊐ Pqa. The code starts with the largest conceivable
value of k, which is min(m, q + 1), and decreases k until Pk ⊐ Pqa.
The running time of COMPUTE-TRANSITION-FUNCTION is O(m3 |Σ|), because the outer
loops contribute a factor of m |Σ|, the inner repeat loop can run at most m + 1 times, and the
test Pk ⊐ Pqa on line 6 can require comparing up to m characters. Much faster procedures
exist; the time required to compute δ from P can be improved to O(m |Σ|) by utilizing some
cleverly computed information about the pattern P (see Exercise 32.4-6). With this improved
procedure for computing δ, we can find all occurrences of a length-m pattern in a length-n text
over an alphabet Σ with O(m |Σ|) preprocessing time and Θ(n) matching time.
Exercises 32.3-1

