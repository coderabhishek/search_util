of 3 elements in an unsuccessful search, so we allocate a hash table of size m = 701. The
number 701 is chosen because it is a prime near 2000/3 but not near any power of 2. Treating
each key k as an integer, our hash function would be
h(k) = k mod 701.

11.3.2 The multiplication method
The multiplication method for creating hash functions operates in two steps. First, we
multiply the key k by a constant A in the range 0 < A < 1 and extract the fractional part of kA.
Then, we multiply this value by m and take the floor of the result. In short, the hash function
is
h(k) = ⌊m(kA mod 1)⌋,
where "k A mod 1" means the fractional part of kA, that is, kA - ⌊kA⌋.
An advantage of the multiplication method is that the value of m is not critical. We typically
choose it to be a power of 2 (m = 2p for some integer p) since we can then easily implement
the function on most computers as follows. Suppose that the word size of the machine is w
bits and that k fits into a single word. We restrict A to be a fraction of the form s/2w, where s is
an integer in the range 0 < s < 2w. Referring to Figure 11.4, we first multiply k by the w-bit
integer s = A · 2w. The result is a 2w-bit value r12w + r0, where r1 is the high-order word of the
product and r0 is the low-order word of the product. The desired p-bit hash value consists of
the p most significant bits of r0.

Figure 11.4: The multiplication method of hashing. The w-bit representation of the key k is
multiplied by the w-bit value s = A · 2w. The p highest-order bits of the lower w-bit half of the
product form the desired hash value h(k).
Although this method works with any value of the constant A, it works better with some
values than with others. The optimal choice depends on the characteristics of the data being
hashed. Knuth [185] suggests that
(11.2)
is likely to work reasonably well.
As an example, suppose we have k = 123456, p = 14, m = 214 = 16384, and w = 32. Adapting
Knuth's suggestion, we choose A to be the fraction of the form s/232 that is closest to
,
so that A = 2654435769/232. Then k · s = 327706022297664 = (76300 · 232) + 17612864, and
so r1 = 76300 and r0 = 17612864. The 14 most significant bits of r0 yield the value h(k) = 67.

