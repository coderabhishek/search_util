Modify the FLOYD-WARSHALL procedure to include computation of the Π(k) matrices
according to equations (25.6) and (25.7). Prove rigorously that for all i V , the predecessor
subgraph Gπ,i is a shortest-paths tree with root i. (Hint: To show that Gπ,i is acyclic, first show
that
implies
, according to the definition of . Then, adapt the proof of
Lemma 24.16.)

Exercises 25.2-4
As it appears above, the Floyd-Warshall algorithm requires Θ(n3) space, since we compute
for i, j, k = 1, 2,...,n. Show that the following procedure, which simply drops all the
superscripts, is correct, and thus only Θ(n2) space is required.

FLOYD-WARSHALL′ (W)
1 n ← rows[W]
2 D ← W
3 for k ← 1 to n
4
do for i ← 1 to n
5
do for j ← 1 to n
6
do dij ← min (dij, dik + dkj)
7 return D

Exercises 25.2-5
Suppose that we modify the way in which equality is handled in equation (25.7):

Is this alternative definition of the predecessor matrix Π correct?

Exercises 25.2-6
How can the output of the Floyd-Warshall algorithm be used to detect the presence of a
negative-weight cycle?

Exercises 25.2-7

Another way to reconstruct shortest paths in the Floyd-Warshall algorithm uses values for
i, j, k = 1, 2,..., n, where is the highest-numbered intermediate vertex of a shortest path from
i to j in which all intermediate vertices are in the set {1, 2,..., k}. Give a recursive formulation

