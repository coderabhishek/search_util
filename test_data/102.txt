The chances that a streak of heads exceeds r ⌈lg n⌉ flips diminish quickly with r. For r ≥ 1,
the probability that a streak of r ⌈lg n⌉ heads starts in position i is
Pr {Ai,r⌈ lg n⌉} = 1/2r⌈ lg n⌉
≤ 1/nr.
Thus, the probability is at most n/nr = 1/nr-1 that the longest streak is at least r ⌈lg n⌉, or
equivalently, the probability is at least 1 - 1/nr-1 that the longest streak has length less than r
⌈lg n⌉.
As an example, for n = 1000 coin flips, the probability of having a streak of at least 2 ⌈lg n⌉ =
20 heads is at most 1/n = 1/1000. The chances of having a streak longer than 3 ⌈lg n⌉ = 30
heads is at most 1/n2 = 1/1,000,000.
We now prove a complementary lower bound: the expected length of the longest streak of
heads in n coin flips is Ω(lg n). To prove this bound, we look for streaks of length s by
partitioning the n flips into approximately n/s groups of s flips each. If we choose s = ⌊(lg
n)/2⌋, we can show that it is likely that at least one of these groups comes up all heads, and
hence it is likely that the longest streak has length at least s = Ω(lg n). We will then show that
the longest streak has expected length Ω(lg n).
We partition the n coin flips into at least ⌊n/ ⌊(lg n)/2⌋⌋ groups of ⌊(lg n)/2⌋ consecutive
flips, and we bound the probability that no group comes up all heads. By equation (5.9), the
probability that the group starting in position i comes up all heads is
Pr {Ai,⌊ (lg n)/⌋} = 1/2⌊(lgn)/⌋
≥
.
The probability that a streak of heads of length at least ⌊(lg n)/2⌋ does not begin in position i
is therefore at most

. Since the ⌊n/ ⌊(lg n)/2⌋⌋ groups are formed from mutually

