Figure 33.11: Key concepts in the proof that the closest-pair algorithm needs to check
only 7 points following each point in the array Y′. (a) If pL PL and pR PR are less
than δ units apart, they must reside within a δ × 2δ rectangle centered at line l. (b)
How 4 points that are pairwise at least δ units apart can all reside within a δ × δ
square. On the left are 4 points in PL, and on the right are 4 points in PR. There can be
8 points in the δ × 2δ rectangle if the points shown on line l are actually pairs of
coincident points with one point in PL and one in PR.
1. It creates an array Y′, which is the array Y with all points not in the 2δ-wide vertical
strip removed. The array Y′ is sorted by y-coordinate, just as Y is.
2. For each point p in the array Y′, the algorithm tries to find points in Y′ that are within δ
units of p. As we shall see shortly, only the 7 points in Y′ that follow p need be
considered. The algorithm computes the distance from p to each of these 7 points and
keeps track of the closest-pair distance δ′ found over all pairs of points in Y′.
3. If δ′ < δ, then the vertical strip does indeed contain a closer pair than was found by the
recursive calls. This pair and its distance δ′ are returned. Otherwise, the closest pair
and its distance δ found by the recursive calls are returned.
The above description omits some implementation details that are necessary to achieve the
O(n lg n) running time. After proving the correctness of the algorithm, we shall show how to
implement the algorithm to achieve the desired time bound.
Correctness
The correctness of this closest-pair algorithm is obvious, except for two aspects. First, by
bottoming out the recursion when |P| ≤ 3, we ensure that we never try to solve a subproblem
consisting of only one point. The second aspect is that we need only check the 7 points
following each point p in array Y′; we shall now prove this property.
Suppose that at some level of the recursion, the closest pair of points is pL PL and pR PR.
Thus, the distance δ′ between pL and pR is strictly less than δ. Point pL must be on or to the left
of line l and less than δ units away. Similarly, pR is on or to the right of l and less than δ units
away. Moreover, pL and pR are within δ units of each other vertically. Thus, as Figure 33.11(a)
shows, pL and pR are within a δ × 2δ rectangle centered at line l. (There may be other points
within this rectangle as well.)
We next show that at most 8 points of P can reside within this δ × 2δ rectangle. Consider the δ
× δ square forming the left half of this rectangle. Since all points within PL are at least δ units
apart, at most 4 points can reside within this square; Figure 33.11(b) shows how. Similarly, at
most 4 points in PR can reside within the δ × δ square forming the right half of the rectangle.
Thus, at most 8 points of P can reside within the δ × 2δ rectangle. (Note that since points on
line l may be in either PL or PR, there may be up to 4 points on l. This limit is achieved if there

