Let the random variable Xi denote the number of probes required by the ith insertion. You
have shown in part (b) that Pr {Xi > 2lg n} ≤ 1/n2. Let the random variable X = max1≤i≤n Xi
denote the maximum number of probes required by any of the n insertions.
c. Show that Pr{X > 2lg n} ≤ 1/n.
d. Show that the expected length E[X] of the longest probe sequence is O(lg n).

Problems 11-2: Slot-size bound for chaining
Suppose that we have a hash table with n slots, with collisions resolved by chaining, and
suppose that n keys are inserted into the table. Each key is equally likely to be hashed to each
slot. Let M be the maximum number of keys in any slot after all the keys have been inserted.
Your mission is to prove an O(lg n/lg lg n) upper bound on E[M], the expected value of M.
a. Argue that the probability Qk that exactly k keys hash to a particular slot is given by

b. Let Pk be the probability that M = k, that is, the probability that the slot containing the
most keys contains k keys. Show that Pk ≤ nQk.
c. Use Stirling's approximation, equation (3.17), to show that Qk < ek/kk.
d. Show that there exists a constant c > 1 such that
for k0 = clg n/ lg lg n.
2<
Conclude that Pk < 1/n for k ≥ k0 = c lg n/ lg lg n.
e. Argue that

Conclude that E[M] = O(lg n/ lg lg n).

Problems 11-3: Quadratic probing
Suppose that we are given a key k to search for in a hash table with positions 0, 1, ..., m - 1,
and suppose that we have a hash function h mapping the key space into the set {0, 1, ..., m 1}. The search scheme is as follows.
1. Compute the value i ← h(k), and set j ← 0.
2. Probe in position i for the desired key k. If you find it, or if this position is empty,
terminate the search.
3. Set j ← (j + 1) mod m and i ← (i + j) mod m, and return to step 2.
Assume that m is a power of 2.

