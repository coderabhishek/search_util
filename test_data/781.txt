Let us call a pair (v, j) of integers acceptable if

,j

{0, 1, ..., t}, and

(mod n).
Acceptable pairs certainly exist since u is odd; we can choose v = n -1 and j = 0, so that (n - 1,
0) is an acceptable pair. Now pick the largest possible j such that there exists an acceptable
pair (v, j), and fix v so that (v, j) is an acceptable pair. Let
.
Since B is closed under multiplication modulo n, it is a subgroup of . By Corollary 31.16,
therefore, |B| divides . Every nonwitness must be a member of B, since the sequence X
produced by a nonwitness must either be all 1's or else contain a -1 no later than the jth
position, by the maximality of j. (If (a, j′) is acceptable, where a is a nonwitness, we must
have j′ ≤ j by how we chose j.)
We now use the existence of v to demonstrate that there exists a
. Since
(mod
n), we have
(mod n1) by Corollary 31.29 to the Chinese remainder theorem. By
Corollary 31.28, there is a w simultaneously satisfying the equations
w ≡ v (mod n1),
w ≡ 1 (mod n2).
Therefore,
≡ -1 (mod n1),
≡ 1 (mod n2).
By Corollary 31.29,
(mod n). Hence,

(mod n1) implies

(mod n), and

(mod n2) implies

(mod n), and so w ∉ B.

It remains to show that
, which we do by first working separately modulo n1 and modulo
n2. Working modulo n1, we observe that since
, we have that gcd(v, n) = 1, and so also
gcd(v, n1) = 1; if v doesn't have any common divisors with n, it certainly doesn't have any
common divisors with n1. Since w ≡ v (mod n1), we see that gcd(w, n1) = 1. Working modulo
n2, we observe that w ≡ 1 (mod n2) implies gcd(w, n2) = 1. To combine these results, we use
Theorem 31.6, which implies that gcd(w, n1n2) = gcd(w, n) = 1. That is,
.
Therefore
.

, and we finish case 2 with the conclusion that B is a proper subgroup of

In either case, we see that the number of witnesses to the compositeness of n is at least (n 1)/2.

Theorem 31.39

