Figure 22.5: Properties of depth-first search. (a) The result of a depth-first search of a directed
graph. Vertices are timestamped and edge types are indicated as in Figure 22.4. (b) Intervals
for the discovery time and finishing time of each vertex correspond to the parenthesization
shown. Each rectangle spans the interval given by the discovery and finishing times of the
corresponding vertex. Tree edges are shown. If two intervals overlap, then one is nested
within the other, and the vertex corresponding to the smaller interval is a descendant of the
vertex corresponding to the larger. (c) The graph of part (a) redrawn with all tree and forward
edges going down within a depth-first tree and all back edges going up from a descendant to
an ancestor.
Theorem 22.7: (Parenthesis theorem)
In any depth-first search of a (directed or undirected) graph G = (V, E), for any two vertices u
and v, exactly one of the following three conditions holds:
•
•
•

the intervals [d[u], f[u]] and [d[v], f[v]] are entirely disjoint, and neither u nor v is a
descendant of the other in the depth-first forest,
the interval [d[u], f[u]] is contained entirely within the interval [d[v], f[v]], and u is a
descendant of v in a depth-first tree, or
the interval [d[v], f[v]] is contained entirely within the interval [d[u], f[u]], and v is a
descendant of u in a depth-first tree.

Proof We begin with the case in which d[u] < d[v]. There are two subcases to consider,
according to whether d[v] < f[u] or not. The first subcase occurs when d[v] < f[u], so v was
discovered while u was still gray. This implies that v is a descendant of u. Moreover, since v

