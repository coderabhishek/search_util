connects a vertex in S, namely s, to a vertex in V - S, namely u. Let us consider the
first vertex y along p such that y V - S, and let x S be y's predecessor. Thus, as
shown in Figure 24.7, path p can be decomposed as
. (Either of paths p1 or
p2 may have no edges.)

Figure 24.7: The proof of Theorem 24.6. Set S is nonempty just before vertex u is
added to it. A shortest path p from source s to vertex u can be decomposed into s
, where y is the first vertex on the path that is not in S and x S
immediately precedes y. Vertices x and y are distinct, but we may have s = x or y = u.
Path p2 may or may not reenter set S.
We claim that d[y] = δ(s, y) when u is added to S. To prove this claim, observe that x
S. Then, because u is chosen as the first vertex for which d[u] ≠ δ(s, u) when it is
added to S, we had d[x] = δ(s, x) when x was added to S. Edge (x, y) was relaxed at
that time, so the claim follows from the convergence property.
We can now obtain a contradiction to prove that d[u] = δ(s, u). Because y occurs
before u on a shortest path from s to u and all edge weights are nonnegative (notably
those on path p2), we have δ(s, y) ≤ δ(s, u), and thus
(24.2)

But because both vertices u and y were in V - S when u was chosen in line 5, we have
d[u] ≤ d[y]. Thus, the two inequalities in (24.2) are in fact equalities, giving
d[y] = δ(s, y) = δ(s, u) = d[u].
Consequently, d[u] = δ(s, u), which contradicts our choice of u. We conclude that d[u]
= δ(s, u) when u is added to S, and that this equality is maintained at all times
thereafter.
•

Termination: At termination, Q = Ø which, along with our earlier invariant that Q =
V - S, implies that S = V. Thus, d[u] = δ(s, u) for all vertices u V.

Corollary 24.7

