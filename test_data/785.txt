by the same recurrence, modulo 19. Every value xi given in part (a) is equivalent, modulo 19,
to the value shown here. For example, both x4 = 63 and x7 = 177 are equivalent to 6, modulo
19. (c) The values produced by the same recurrence, modulo 73. Every value xi given in part
(a) is equivalent, modulo 73, to the value shown here. By the Chinese remainder theorem,
each node in part (a) corresponds to a pair of nodes, one from part (b) and one from part (c).
Let us consider the question of how long it takes for the sequence of xi to repeat. This is not
exactly what we need, but we shall then see how to modify the argument.
For the purpose of this estimation, let us assume that the function
fn(x) = (x2 - 1) mod n
behaves like a "random" function. Of course, it is not really random, but this assumption
yields results consistent with the observed behavior of POLLARD-RHO. We can then
consider each xi to have been independently drawn from Zn according to a uniform
distribution on Zn. By the birthday-paradox analysis of Section 5.4.1, the expected number of
steps taken before the sequence cycles is
.
Now for the required modification. Let p be a nontrivial factor of n such that gcd(p, n/p) = 1.
For example, if n has the factorization
, then we may take p to be . (If e1 = 1,
then p is just the smallest prime factor of n, a good example to keep in mind.)
The sequence

xi

induces a corresponding sequence

modulo p, where

mod p
for all i.
Furthermore, because fn is defined using only arithmetic operations (squaring and subtraction)
modulo n, we shall see that one can compute from the "modulo p" view of the sequence is
a smaller version of what is happening modulo n:
= xi+1 mod p
= fn(xi) mod p
=(
mod n) mod p
=

mod p
= ((xi mod p)2 - 1) mod p
=
mod p
=
.

(by Exercise 31.1-6)

Thus, although we are not explicitly computing the sequence
and obeys the same recurrence as the sequence xi .

, this sequence is well defined

Reasoning as before, we find that the expected number of steps before the sequence repeats
is
. If p is small compared to n, the sequence may repeat much more quickly than the
sequence xi . Indeed, the sequence repeats as soon as two elements of the sequence xi

