where nj is the number of keys hashing to slot j.
Proof We start with the following identity, which holds for any nonnegative integer a:
(11.6)
We have

To evaluate the summation
, we observe that it is just the total number of collisions.
By the properties of universal hashing, the expected value of this summation is at most

since m = n. Thus,

Corollary 11.11
If we store n keys in a hash table of size m = n using a hash function h randomly chosen from
a universal class of hash functions and we set the size of each secondary hash table to
for j = 0, 1, ..., m - 1, then the expected amount of storage required for all secondary hash
tables in a perfect hashing scheme is less than 2n.
Proof Since

for j = 0, 1, ..., m - 1, Theorem 11.10 gives

